---
execute:
    warning: false
    echo: false

jupyter: python3
---

# Introduction {.unnumbered}

```{python}
# | tags: [parameters]

version_file = "versions.yml"
parameters_file = "parameters.yaml"
```

```{python}
from datetime import datetime
import os

import yaml
import pandas as pd
from bs4 import BeautifulSoup

with open(version_file, "r") as file:
    yaml_data = yaml.safe_load(file)
# parse versions.yml
rows = []
nextflow_version = pipeline_version = None
#
for group, software_versions in yaml_data.items():
    for software, version in software_versions.items():
        if group == "Workflow":
            if software == "Nextflow":
                nextflow_version = version
            else:
                pipeline_version = version
        rows.append({"group": group, "software": software, "version": version})
#
versions = pd.DataFrame(rows)
#
# parse parameters
#
with open(parameters_file, "r") as file:
    yaml_data = yaml.safe_load(file)
#
line = None
param_lines = []
#
for s in BeautifulSoup(yaml_data["data"]).stripped_strings:
    if "options" in s:
        param_lines.append(s)
    elif line is None:
        line = f"\t{s}"
    else:
        param_lines.append(f"{line}: {s}")
        line = None
```

This report has been generated by the <a href="https://github.com/dsidlab/spatial-ir-pipeline/tree/dev" target="_blank">spatial-ir-pipeline</a> `{python} pipeline_version`. The report was generated on `{python} datetime.now().strftime("%Y-%m-%d %H:%M:%S")` and executed with Nextflow v`{python} nextflow_version` [@DiTommaso2017].

The report consists of 3 sections, an overall summary of immune receptor data and separate summaries of T and B cell receptor data. Click on the section headers on the left to begin.


## Parameters {.unnumbered}
The following parameters were used to run this pipeline.

```{python}
print("\n".join(param_lines))
```

## Software Versions {.unnumbered}
The following is a list of software versions used to render the report.

```{python}
versions
```
