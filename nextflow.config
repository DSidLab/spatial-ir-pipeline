/*
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    spatial-ir Nextflow config file
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    Default config options for all compute environments
----------------------------------------------------------------------------------------
*/

// Global default params, used in configs
params {

    // Input and Output options
    input                      = null
    outdir                     = 'out'

    // Max resource options
    // Defaults only, expecting to be overwritten
    max_cpus                   = 12
    max_memory                 = '128.GB'
    max_time                   = '48.h'
    
    // Boilerplate options
    help                       = false
    version                    = false
    publish_dir_mode           = 'copy'
    monochrome_logs            = false
    hook_url                   = null
    validate_params            = true
    validationShowHiddenParams       = false
    validationFailUnrecognisedParams = false
    validationLenientMode            = false    
    
}

timeline {
    enabled = true
    file = "$params.outdir/pipeline_info/execution_timeline.html"
    overwrite = true
}
report {
    enabled = true
    file = "$params.outdir/pipeline_info/pipeline_report.html"
    overwrite = true
}
trace {
    enabled = true
    file = "$params.outdir/pipeline_info/execution_trace.txt"
    overwrite = true
}
dag {
    enabled = true
    file = "$params.outdir/pipeline_info/pipeline_dag.html"
    overwrite = true
}

// Load base.config by default for all pipelines
includeConfig 'conf/base.config'

profiles {
    test      { includeConfig 'conf/test.config'      }
    test_full { includeConfig 'conf/test_full.config' }
}


// Nextflow plugins
// Validation of pipeline parameters and creation of an input channel from a sample sheet
plugins {
    id 'nf-validation' 
}

env {
    PYTHONNOUSERSITE = 1
    R_PROFILE_USER   = "/.Rprofile"
    R_ENVIRON_USER   = "/.Renviron"
}

// Capture exit codes from upstream processes when piping
process.shell = ['/bin/bash', '-euo', 'pipefail']

manifest {
    name            = 'disidlab/spatial-ir'
    author          = """"""
    homePage        = 'https://github.com/DSidLab/spatial-ir-pipeline'
    description     = """spatial immune receptor pipeline"""
    mainScript      = 'main.nf'
    nextflowVersion = '!>=23.04.0'
    version         = '0.0.1'
    doi             = ''
}

includeConfig 'conf/modules.config'